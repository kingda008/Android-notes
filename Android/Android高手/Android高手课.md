





# 高质量开发

## 1，崩溃优化

​		Android 的两种崩溃我们都知道，Android 崩溃分为 **Java 崩溃和 Native 崩溃**。

​		简单来说，Java 崩溃就是在 Java 代码中，出现了未捕获异常，导致程序异常退出。那 Native 崩溃又是怎么产生的呢？一般都是因为在 Native 代码中访问非法地址，也可能是地址对齐出现了问题，或者发生了程序主动 abort，这些都会产生相应的 signal 信号，导致程序异常退出。

​		所以，“崩溃”就是程序出现异常，而一个产品的崩溃率，跟我们如何捕获、处理这些异常有比较大的关系。Java 崩溃的捕获比较简单，但是很多同学对于如何捕获 Native 崩溃还是一知半解，下面我就重点介绍 Native 崩溃的捕获流程和难点。

​		**1.Native 崩溃的捕获流程** 

​		如果你对 Native 崩溃机制的一些基本知识还不是很熟悉，建议你阅读一下《Android 平台 Native 代码的崩溃捕获机制及实现》。这里我着重给你讲讲一个完整的 Native 崩溃从捕获到解析要经历哪些流程。

​		编译端。编译 C/C++ 代码时，需要将带符号信息的文件保留下来。

​		客户端。捕获到崩溃时候，将收集到尽可能多的有用信息写入日志文件，然后选择合适的时机上传到服务器。

​		服务端。读取客户端上报的日志文件，寻找适合的符号文件，生成可读的 C/C++ 调用栈。

​	![img](Android%E9%AB%98%E6%89%8B%E8%AF%BE.assets/95d9733860e3a52c6c3b5976ca25b711.jpg)

